!function(t){var e={};function o(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(s,r,function(e){return t[e]}.bind(null,r));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);o(1);const s={elements:{toolsContainer:document.querySelectorAll(".toolsContainer__item"),paintBucket:document.getElementById("paintBucket"),colorPicker:document.getElementById("colorPicker"),pencil:document.getElementById("pencil"),currentColor:document.getElementById("input-color"),prevColor:document.querySelector("#prevColor .circleColor"),canvas:document.getElementById("canvas"),ctx:document.getElementById("canvas").getContext("2d"),searchForm:document.getElementById("searchForm"),searchInput:document.querySelector(".form-control"),selectedCity:document.querySelector(".selectedCity")},colors:{currentColor:"#FF8F00",prevColor:"#000000",red:"#FF0000",blue:"#00BCD4"},state:{activeTool:null,colorRGBA:[],colorHEX:""},canvasParams:{width:512,height:512,resolution:4},init(){if(this.elements.prevColor.style.background="#000000",this.colors.currentColor=this.elements.currentColor.value.toString(),this.state.activeTool=this.elements.pencil.id,this.elements.pencil.classList.add("active"),this.elements.canvas.width=this.canvasParams.width,this.elements.canvas.height=this.canvasParams.height,this.inputColorPicker(),this.eventListeners(),localStorage.getItem("canvasImg")){const t=new Image;t.src=localStorage.getItem("canvasImg"),t.addEventListener("load",()=>{this.elements.ctx.drawImage(t,0,0)})}else this.elements.ctx.rect(0,0,512,512),this.elements.ctx.fillStyle="#FFFFFF",this.elements.ctx.fill()},inputColorPicker(){this.elements.currentColor.addEventListener("change",t=>{const e=document.getElementById("input-color");let o=0;this.colors.prevColor=this.colors.currentColor,this.elements.prevColor.style.background=this.colors.currentColor,e.addEventListener("focus",()=>{(o+=1)>0&&(this.colors.currentColor=t.target.value,this.state.colorRGBA=this.hexToRGBA(this.colors.currentColor))})})},colorPicker(t){const e=this.elements.ctx.getImageData(t.offsetX,t.offsetY,1,1);return"canvas"===t.target.id&&"colorPicker"===this.state.activeTool&&(this.elements.currentColor.value=this.RGBAtoHEX(e.data)),this.RGBAtoHEX(e.data).toUpperCase()},fillBucket(){const t=this.elements.ctx.createImageData(this.elements.canvas.width,this.elements.canvas.height),e=this.hexToRGBA(this.colors.currentColor);for(let o=0;o<t.data.length;o+=4)t.data[o]=e[0],t.data[o+1]=e[1],t.data[o+2]=e[2],t.data[o+3]=255;this.elements.ctx.putImageData(t,0,0)},draw(t){const e=this.canvasParams.width/this.canvasParams.resolution,o=Math.trunc(t.offsetX/e)*e,s=Math.trunc(t.offsetY/e)*e,r=this.elements.ctx.createImageData(e,e);for(let t=0;t<r.data.length;t+=4)r.data[t]=this.state.colorRGBA[0],r.data[t+1]=this.state.colorRGBA[1],r.data[t+2]=this.state.colorRGBA[2],r.data[t+3]=255;this.elements.ctx.putImageData(r,o,s)},scaleCanvas(){},switchTool(t,e){const o=t.target.closest(".toolsContainer__item");switch(t.type){case"mousedown":o&&this.state.activeTool!==o.id&&o.id&&(this.state.activeTool=o.id,this.elements.toolsContainer.forEach(t=>{t.classList.remove("active")}),document.getElementById(o.id).classList.add("active"));break;case"keydown":this.elements.toolsContainer.forEach(t=>{t.classList.remove("active")}),this.state.activeTool=e,document.getElementById(e).classList.add("active")}},hexToRGBA(t){let e=[];if(t){const o=t.replace("#","");e=[parseInt(o.substr(0,2),16),parseInt(o.substr(2,2),16),parseInt(o.substr(4,2),16),255],this.state.colorRGBA=e}return e},RGBAtoHEX(t){if("string"==typeof t){let e="#";return t.replace("rgb","").replace("(","").replace(")","").replace(" ","").replace(" ","").split(",").forEach(t=>{t<16&&(e+=0),e+=Number(t).toString(16)}),this.state.colorHEX=e,e}const e=Array.from(t);e.pop();const o=`rgb(${e.join(",")})`;return this.RGBAtoHEX(o)},eventListeners(){window.addEventListener("mousedown",t=>{const e="CANVAS"===t.target.tagName;if(this.switchTool(t),t.target.classList.contains("sideBar__item")?this.canvasParams.resolution=t.target.children[0].value:t.target.classList.contains("checkmark")?this.canvasParams.resolution=t.target.previousSibling.previousSibling.value:t.target.classList.contains("input-radio")&&(this.canvasParams.resolution=t.target.value),e)switch(this.state.activeTool){case"paintBucket":this.fillBucket();break;case"colorPicker":this.colors.currentColor=this.colorPicker(t),this.state.colorRGBA=this.hexToRGBA(this.colors.currentColor);break;case"pencil":this.draw(t),this.state.mousedown=!0}switch(t.target.id){case"prevColor":this.colors.currentColor=this.RGBAtoHEX(this.elements.prevColor.style.background),this.elements.currentColor.value=this.RGBAtoHEX(this.elements.prevColor.style.background),this.state.colorRGBA=this.hexToRGBA(this.colors.currentColor);break;case"red":this.colors.currentColor="#FF0000",this.state.colorRGBA=this.hexToRGBA(this.colors.currentColor),this.elements.currentColor.value="#FF0000";break;case"blue":this.colors.currentColor="#0b00d4",this.state.colorRGBA=this.hexToRGBA(this.colors.currentColor),this.elements.currentColor.value="#0b00d4"}}),window.addEventListener("mousemove",t=>{this.state.mousedown&&this.draw(t)}),window.addEventListener("mouseup",()=>{this.state.mousedown=!1}),window.addEventListener("keydown",t=>{switch(t.code){case"KeyB":this.switchTool(t,"paintBucket");break;case"KeyP":this.switchTool(t,"pencil");break;case"KeyC":this.switchTool(t,"colorPicker")}}),this.elements.searchForm.addEventListener("submit",t=>{t.preventDefault(),console.log(this.elements.searchInput.value),this.elements.selectedCity.textContent=this.elements.searchInput.value,this.elements.searchForm.reset()})}};s.init(),window.addEventListener("unload",()=>{const t=s.elements.canvas;localStorage.setItem("canvasImg",t.toDataURL())})},function(t,e,o){}]);